<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Admin - El Artesano</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        button {
            padding: 10px 20px;
            margin: 10px;
            background: #000;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background: #333;
        }
        pre {
            background: #f0f0f0;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
        }
        .success {
            color: green;
            font-weight: bold;
        }
        .error {
            color: red;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§ª Test de Admin Panel - El Artesano</h1>
        <p>Prueba las funciones del panel de administraciÃ³n aquÃ­</p>
        
        <div>
            <button onclick="testProductos()">ğŸ“¦ Test Productos</button>
            <button onclick="testCursos()">ğŸ“š Test Cursos</button>
            <button onclick="testOrdenes()">ğŸ“‹ Test Ã“rdenes</button>
            <button onclick="limpiarResultados()">ğŸ—‘ï¸ Limpiar</button>
        </div>
        
        <div id="resultado"></div>
    </div>

    <script>
        const API_BASE = window.location.origin;

        function mostrarResultado(titulo, data, esExito = true) {
            const resultado = document.getElementById('resultado');
            const color = esExito ? 'success' : 'error';
            resultado.innerHTML += `
                <h3 class="${color}">${titulo}</h3>
                <pre>${JSON.stringify(data, null, 2)}</pre>
                <hr>
            `;
        }

        async function testProductos() {
            try {
                console.log('ğŸ” Testeando /api/productos...');
                const response = await fetch(`${API_BASE}/api/productos`);
                console.log('Response status:', response.status);
                console.log('Response headers:', response.headers.get('content-type'));
                
                const data = await response.json();
                console.log('Datos recibidos:', data);
                
                if (data.success && data.data) {
                    mostrarResultado(
                        `âœ… Productos OK (${data.data.length} productos)`, 
                        {
                            total: data.data.length,
                            modo: data.modo,
                            primeros_3: data.data.slice(0, 3).map(p => ({
                                id: p.id,
                                nombre: p.nombre,
                                precio: p.precio,
                                categoria: p.categoria
                            }))
                        },
                        true
                    );
                } else {
                    mostrarResultado('âŒ Error en Productos', data, false);
                }
            } catch (error) {
                mostrarResultado('âŒ Error de ConexiÃ³n - Productos', {
                    error: error.message,
                    stack: error.stack
                }, false);
            }
        }

        async function testCursos() {
            try {
                console.log('ğŸ” Testeando /api/cursos...');
                const response = await fetch(`${API_BASE}/api/cursos`);
                console.log('Response status:', response.status);
                console.log('Response headers:', response.headers.get('content-type'));
                
                const data = await response.json();
                console.log('Datos recibidos:', data);
                
                if (data.success && data.data) {
                    mostrarResultado(
                        `âœ… Cursos OK (${data.data.length} cursos)`,
                        {
                            total: data.data.length,
                            modo: data.modo,
                            primeros_3: data.data.slice(0, 3).map(c => ({
                                id: c.id,
                                titulo: c.titulo,
                                precio: c.precio,
                                nivel: c.nivel
                            }))
                        },
                        true
                    );
                } else {
                    mostrarResultado('âŒ Error en Cursos', data, false);
                }
            } catch (error) {
                mostrarResultado('âŒ Error de ConexiÃ³n - Cursos', {
                    error: error.message,
                    stack: error.stack
                }, false);
            }
        }

        async function testOrdenes() {
            try {
                console.log('ğŸ” Testeando /api/ordenes/admin/all...');
                const response = await fetch(`${API_BASE}/api/ordenes/admin/all`);
                console.log('Response status:', response.status);
                
                const data = await response.json();
                console.log('Datos recibidos:', data);
                
                if (data.success) {
                    const numOrdenes = data.data ? data.data.length : 0;
                    mostrarResultado(
                        `âœ… Ã“rdenes OK (${numOrdenes} Ã³rdenes)`,
                        {
                            total: numOrdenes,
                            modo: data.modo,
                            primeras_3: data.data ? data.data.slice(0, 3).map(o => ({
                                numero_orden: o.numero_orden,
                                total: o.total,
                                estado: o.estado
                            })) : []
                        },
                        true
                    );
                } else {
                    mostrarResultado('âŒ Error en Ã“rdenes', data, false);
                }
            } catch (error) {
                mostrarResultado('âŒ Error de ConexiÃ³n - Ã“rdenes', {
                    error: error.message,
                    stack: error.stack
                }, false);
            }
        }

        function limpiarResultados() {
            document.getElementById('resultado').innerHTML = '';
        }

        // Auto-ejecutar tests al cargar
        window.addEventListener('DOMContentLoaded', () => {
            console.log('ğŸš€ PÃ¡gina de test cargada');
            setTimeout(() => {
                testProductos();
                setTimeout(testCursos, 1000);
            }, 500);
        });
    </script>
</body>
</html>
